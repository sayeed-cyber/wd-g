<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLUE SEA AQUARIUM | Premium Marine & Tropical</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- CUSTOM STYLES --- */
        body {
            margin: 0;
            overflow-x: hidden;
            background-color: #00050a;
            color: white;
            font-family: 'Rajdhani', sans-serif;
            scroll-behavior: smooth;
        }

        #canvas-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100vh;
            z-index: 0; pointer-events: all;
        }

        .ui-layer { position: relative; z-index: 10; pointer-events: none; }
        .pointer-events-auto { pointer-events: auto; }

        h1, h2, h3, .brand-font { font-family: 'Orbitron', sans-serif; }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(4, 15, 30, 0.85); /* Slightly darker for menu legibility */
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 195, 255, 0.15);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(0, 195, 255, 0.7), 0 0 20px rgba(0, 195, 255, 0.3);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #00050a; }
        ::-webkit-scrollbar-thumb { background: #004e64; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00c3ff; }

        .loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #00050a; z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 1s ease;
        }

        /* Map Placeholder Animation */
        .map-frame {
            border: 1px solid #00c3ff;
            box-shadow: 0 0 15px rgba(0, 195, 255, 0.2);
            transition: all 0.3s ease;
        }
        .map-frame:hover {
            box-shadow: 0 0 25px rgba(0, 195, 255, 0.5);
        }

        /* Mobile hamburger & menu animations */
        .mobile-hamburger {
            width: 44px;
            height: 36px;
            display: inline-flex;
            flex-direction: column;
            justify-content: center;
            gap: 6px;
            padding: 4px;
            color: #00c3ff;
        }
        .mobile-hamburger .bar {
            display: block;
            height: 3px;
            background: currentColor;
            border-radius: 2px;
            transition: transform .35s cubic-bezier(.2,.9,.2,1), opacity .2s ease;
            transform-origin: center;
        }
        .mobile-hamburger .bar1 { width: 22px; }
        .mobile-hamburger .bar2 { width: 18px; }
        .mobile-hamburger .bar3 { width: 22px; }
        .mobile-hamburger.open .bar1 { transform: translateY(6px) rotate(45deg); }
        .mobile-hamburger.open .bar2 { opacity: 0; transform: scaleX(0); }
        .mobile-hamburger.open .bar3 { transform: translateY(-6px) rotate(-45deg); }

        .mobile-menu {
            position: fixed;
            left: 0; right: 0; top: 0;
            transform: translateY(-100%);
            transition: transform .45s cubic-bezier(.2,.9,.2,1);
            z-index: 45;
            padding-top: 72px; /* allow space for nav */
            min-height: 100vh;
            background: linear-gradient(180deg, rgba(3,7,14,0.96), rgba(3,7,14,0.98));
            backdrop-filter: blur(14px);
            pointer-events: auto;
        }
        .mobile-menu.open { transform: translateY(0); }
        .mobile-menu .mobile-link { padding: 16px 0; border-bottom: 1px solid rgba(0,195,255,0.04); width: 100%; display: block; color: #cfeeff; font-size: 1.05rem; transform: translateY(10px); opacity: 0; transition: transform .45s cubic-bezier(.2,.9,.2,1), opacity .35s ease; }
        .mobile-menu .mobile-link:hover { color: #00e6ff; transform: translateY(0) scale(1.02); }
        /* Decorative animated glow behind menu */
        .mobile-menu::before {
            content: '';
            position: absolute; inset: 0; z-index: 0;
            background: radial-gradient( at 20% 20%, rgba(0,195,255,0.09), transparent 10%), radial-gradient(at 80% 80%, rgba(0,120,255,0.06), transparent 15%);
            mix-blend-mode: screen; pointer-events: none; transition: opacity .4s ease;
        }
        .mobile-menu .menu-inner { position: relative; z-index: 1; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding-top:40px; gap:12px; }
        .mobile-menu.open .mobile-link { transform: translateY(0); opacity: 1; }
        body.menu-open { overflow: hidden; height: 100%; }
    </style>
</head>
<body>

    <div id="loader" class="loader">
        <div class="text-center">
            <h1 class="text-4xl text-cyan-400 font-bold tracking-widest animate-pulse brand-font">BLUE SEA AQUARIUM</h1>
            <p class="text-cyan-900 mt-2 font-mono text-sm uppercase">Loading Ecosystem...</p>
        </div>
    </div>

    <div id="canvas-container"></div>

    <div class="ui-layer">
        
        <nav class="w-full fixed top-0 pointer-events-auto z-50 transition-all duration-300">
            <div class="flex justify-between items-center p-6 md:p-8 bg-gradient-to-b from-black/90 to-transparent backdrop-blur-sm">
                <div class="text-2xl md:text-3xl font-bold tracking-tighter neon-text brand-font text-cyan-400">
                    <i class="fas fa-water mr-2"></i>BLUE SEA
                </div>
                
                <div class="hidden md:flex space-x-8 font-bold tracking-widest text-sm text-gray-300">
                    <a href="#home" class="hover:text-cyan-400 transition">HOME</a>
                    <a href="#about" class="hover:text-cyan-400 transition">ABOUT</a>
                    <a href="#livestock" class="hover:text-cyan-400 transition">LIVESTOCK</a>
                    <a href="#products" class="hover:text-cyan-400 transition">PRODUCTS</a>
                    <a href="#contact" class="hover:text-cyan-400 transition">LOCATION</a>
                </div>
                <a href="#contact" class="hidden md:block border border-cyan-400 px-6 py-2 rounded-none text-cyan-400 hover:bg-cyan-400 hover:text-black transition uppercase text-xs font-bold tracking-widest">
                    Visit Us
                </a>

                <button id="mobile-menu-btn" class="md:hidden mobile-hamburger focus:outline-none" aria-expanded="false" aria-label="Toggle menu">
                    <span class="bar bar1"></span>
                    <span class="bar bar2"></span>
                    <span class="bar bar3"></span>
                </button>
            </div>

            <div id="mobile-menu" class="mobile-menu md:hidden glass-panel border-t border-cyan-900" role="dialog" aria-modal="true">
                <div class="menu-inner font-bold tracking-widest text-sm text-gray-300 w-full max-w-xl px-8">
                    <a href="#home" class="mobile-link hover:text-cyan-400 transition text-center">HOME</a>
                    <a href="#about" class="mobile-link hover:text-cyan-400 transition text-center">ABOUT</a>
                    <a href="#livestock" class="mobile-link hover:text-cyan-400 transition text-center">LIVESTOCK</a>
                    <a href="#products" class="mobile-link hover:text-cyan-400 transition text-center">PRODUCTS</a>
                    <a href="#contact" class="mobile-link hover:text-cyan-400 transition text-center">LOCATION</a>
                </div>
            </div>
        </nav>

        <header id="home" class="h-screen flex flex-col justify-center items-center text-center px-4">
            <p class="text-cyan-500 tracking-[0.4em] text-xs md:text-sm mb-4 animate-bounce font-bold">Blue Sea</p>
            <h1 class="text-5xl md:text-8xl font-black mb-6 leading-tight text-white drop-shadow-lg">
                BRING THE OCEAN<br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600 neon-text">HOME</span>
            </h1>
            <p class="max-w-2xl text-gray-300 text-lg md:text-xl mb-10 leading-relaxed font-light">
                Your premier destination for exotic marine life, custom aquascaping, and professional aquarium maintenance.
            </p>
            <div class="flex space-x-4 pointer-events-auto">
                <a href="#livestock" class="glass-panel px-8 py-4 text-cyan-300 border border-cyan-800 hover:bg-cyan-900/40 transition duration-300 uppercase tracking-widest font-bold text-sm">
                    View Fishes
                </a>
                <a href="#contact" class="bg-cyan-500 text-black px-8 py-4 hover:bg-white transition duration-300 uppercase tracking-widest font-bold text-sm border border-cyan-500">
                    Find Shop
                </a>
            </div>
        </header>

        <section id="about" class="min-h-[60vh] flex items-center justify-center py-20 px-4">
            <div class="container mx-auto">
                <div class="glass-panel p-8 md:p-12 rounded-sm pointer-events-auto border-l-4 border-l-cyan-400">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-6 text-white brand-font">WHO WE ARE</h2>
                            <p class="text-gray-300 text-lg mb-6 leading-relaxed">
                                At <strong>Blue Sea Aquarium</strong>, we are passionate hobbyists first and shop owners second. We specialize in creating sustainable underwater ecosystems that become the centerpiece of your home or office.
                            </p>
                            <ul class="space-y-4 text-gray-400">
                                <li class="flex items-center"><i class="fas fa-check text-cyan-400 mr-4"></i> Ethically Sourced Marine Life</li>
                                <li class="flex items-center"><i class="fas fa-check text-cyan-400 mr-4"></i> Custom Tank Fabrication</li>
                                <li class="flex items-center"><i class="fas fa-check text-cyan-400 mr-4"></i> 24/7 Emergency Support</li>
                            </ul>
                        </div>
                        <div class="h-64 md:h-full bg-blue-900/30 rounded-lg flex items-center justify-center border border-white/10 relative overflow-hidden group">
                            <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1524704654690-b56c05c78a00?q=80&w=1000&auto=format&fit=crop')] bg-cover bg-center opacity-60 group-hover:scale-110 transition duration-700"></div>
                            <div class="relative z-10 text-center">
                                <h3 class="text-6xl font-bold text-white/20">SINCE</h3>
                                <h3 class="text-6xl font-bold text-cyan-400 neon-text">2015</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="livestock" class="py-20 px-4">
            <div class="container mx-auto">
                <div class="text-center mb-16">
                    <p class="text-cyan-400 tracking-widest text-sm font-bold mb-2">OUR COLLECTION</p>
                    <h2 class="text-5xl font-bold text-white brand-font">LIVE STOCK</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="glass-panel p-6 pointer-events-auto hover:-translate-y-2 transition duration-300 group">
                        <div class="h-48 bg-black/40 mb-6 flex items-center justify-center overflow-hidden border border-white/5">
                            <i class="fas fa-fish text-6xl text-cyan-600 group-hover:text-cyan-400 transition"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-2 text-white">Exotic Marine</h3>
                        <p class="text-gray-400 text-sm mb-4">Clownfish, Tangs, Angelfish and rare saltwater specimens imported weekly.</p>
                        <span class="text-cyan-400 text-xs font-bold tracking-widest border-b border-cyan-400 pb-1">VIEW STOCK</span>
                    </div>

                    <div class="glass-panel p-6 pointer-events-auto hover:-translate-y-2 transition duration-300 group">
                        <div class="h-48 bg-black/40 mb-6 flex items-center justify-center overflow-hidden border border-white/5">
                            <i class="fas fa-leaf text-6xl text-green-600 group-hover:text-green-400 transition"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-2 text-white">Planted Tropical</h3>
                        <p class="text-gray-400 text-sm mb-4">High-tech aquatic plants, schooling tetras, discus, and award-winning bettas.</p>
                        <span class="text-cyan-400 text-xs font-bold tracking-widest border-b border-cyan-400 pb-1">VIEW STOCK</span>
                    </div>

                    <div class="glass-panel p-6 pointer-events-auto hover:-translate-y-2 transition duration-300 group">
                        <div class="h-48 bg-black/40 mb-6 flex items-center justify-center overflow-hidden border border-white/5">
                            <i class="fas fa-dragon text-6xl text-red-600 group-hover:text-red-400 transition"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-2 text-white">Monster Fish</h3>
                        <p class="text-gray-400 text-sm mb-4">Premium Arowanas, Flowerhorns, and Stingrays for the dedicated enthusiast.</p>
                        <span class="text-cyan-400 text-xs font-bold tracking-widest border-b border-cyan-400 pb-1">VIEW STOCK</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="products" class="py-20 px-4">
            <div class="container mx-auto">
                <div class="glass-panel p-10 rounded-xl pointer-events-auto">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-10 border-b border-gray-700 pb-6">
                        <div>
                            <h2 class="text-4xl font-bold brand-font text-white">SUPPLIES & TECH</h2>
                            <p class="text-gray-400 mt-2">Everything you need to keep your ecosystem thriving.</p>
                        </div>
                        <button class="mt-4 md:mt-0 bg-cyan-600/20 text-cyan-400 px-6 py-2 border border-cyan-400/50 hover:bg-cyan-400 hover:text-black transition uppercase text-xs font-bold">
                            Download Catalog
                        </button>
                    </div>

                    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                        <div class="p-4 hover:bg-white/5 transition rounded">
                            <i class="fas fa-cube text-3xl text-blue-400 mb-3"></i>
                            <h4 class="font-bold">Custom Tanks</h4>
                        </div>
                        <div class="p-4 hover:bg-white/5 transition rounded">
                            <i class="fas fa-filter text-3xl text-blue-400 mb-3"></i>
                            <h4 class="font-bold">Filtration</h4>
                        </div>
                        <div class="p-4 hover:bg-white/5 transition rounded">
                            <i class="fas fa-lightbulb text-3xl text-blue-400 mb-3"></i>
                            <h4 class="font-bold">Lighting</h4>
                        </div>
                        <div class="p-4 hover:bg-white/5 transition rounded">
                            <i class="fas fa-cookie text-3xl text-blue-400 mb-3"></i>
                            <h4 class="font-bold">Premium Food</h4>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer id="contact" class="bg-black/90 pt-20 border-t border-cyan-900/30 pointer-events-auto relative">
            <div class="container mx-auto px-4 pb-12">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                    
                    <div>
                        <h2 class="text-3xl font-bold mb-6 brand-font text-white">VISIT THE SHOP</h2>
                        <div class="space-y-6 text-gray-300">
                            <div class="flex items-start">
                                <i class="fas fa-map-marker-alt text-cyan-400 mt-1 w-8"></i>
                                <div>
                                    <h4 class="font-bold text-white">Address</h4>
                                    <p>166, HKP Road, opposite hamza hotel, Sulthangunta, Shivaji Nagar<br>Bengaluru, Karnataka 560051</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fas fa-phone text-cyan-400 mt-1 w-8"></i>
                                <div>
                                    <h4 class="font-bold text-white">Phone</h4>
                                    <p>+91 93417 84868</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fas fa-clock text-cyan-400 mt-1 w-8"></i>
                                <div>
                                    <h4 class="font-bold text-white">Hours</h4>
                                    <p>Mon - Sat: 10:00 AM - 9:00 PM<br>Sunday: 11:00 AM - 7:00 PM</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex space-x-4 mt-8">
                            <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-cyan-500 hover:text-black transition"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-blue-600 hover:text-white transition"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-green-500 hover:text-white transition"><i class="fab fa-whatsapp"></i></a>
                        </div>
                    </div>

                    <div class="map-frame h-64 md:h-full bg-gray-900 rounded-lg overflow-hidden relative">
                        <iframe
                            src="https://www.google.com/maps?q=12.986203364042835,77.60499989227914&output=embed"
                            width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy">
                        </iframe>
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-800 py-6 text-center text-gray-600 text-xs tracking-widest uppercase">
                <p>Â© 2025 BLUE SEA AQUARIUM. ALL RIGHTS RESERVED.</p>
                <p class="mt-2 text-cyan-900">Designed by Sayeed Khan</p>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/LuminosityHighPassShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

    <script>
        // --- THREE.JS LOGIC ---
        // (Keeping your original Boids/Fish Logic as it is perfect for the theme)
        
        const FISH_COUNT = 30; // Slight reduction for performance on phones
        const NEIGHBOR_DIST = 10;
        const SEPARATION_DIST = 4;
        
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x00050a, 0.025); // Slightly denser fog for depth

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 40);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.toneMapping = THREE.ReinhardToneMapping;
        container.appendChild(renderer.domElement);

        const renderScene = new THREE.RenderPass(scene, camera);
        // Adjusted Bloom for "Deep Sea" feel (more subtle)
        const bloomPass = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0.15;
        bloomPass.strength = 1.0;
        bloomPass.radius = 0.4;

        const composer = new THREE.EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);

        const ambientLight = new THREE.AmbientLight(0x001133, 3.5);
        scene.add(ambientLight);
        // Changed Directional Light to Cyan/Blue
        const sunLight = new THREE.DirectionalLight(0x00c3ff, 1.2);
        sunLight.position.set(0, 50, 20);
        scene.add(sunLight);
        const cursorLight = new THREE.PointLight(0x00c3ff, 2, 40); // Blue cursor light
        scene.add(cursorLight);

        // --- SHADERS (Unchanged logic, just color tweaks in instantiation) ---
        const fishVertexShader = `
            uniform float time;
            varying vec2 vUv;
            varying vec3 vNormal;
            void main() {
                vUv = uv; vNormal = normal;
                vec3 pos = position;
                float bodyFlex = smoothstep(1.0, -5.0, pos.z); 
                float wave = sin(time * 8.0 + pos.z * 1.5);
                pos.x += wave * bodyFlex * 0.6;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
            }
        `;

        const fishFragmentShader = `
            uniform vec3 color;
            uniform vec3 glowColor;
            varying vec3 vNormal;
            void main() {
                vec3 lightDir = normalize(vec3(0.5, 1.0, 0.5));
                float diff = max(dot(vNormal, lightDir), 0.0);
                float fresnel = pow(1.0 - dot(vNormal, vec3(0, 0, 1.0)), 3.0);
                vec3 base = color * (0.4 + diff * 0.6);
                vec3 finalColor = mix(base, glowColor, fresnel * 0.8);
                gl_FragColor = vec4(finalColor, 1.0);
            }
        `;

        function createOrganicFish() {
            const fishGroup = new THREE.Group();
            const shaderMat = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    color: { value: new THREE.Color(0x00aaff) },
                    glowColor: { value: new THREE.Color(0x00ffaa) }
                },
                vertexShader: fishVertexShader,
                fragmentShader: fishFragmentShader,
                side: THREE.DoubleSide
            });

            // Simplified geometry creation for brevity (Logic identical to your code)
            const points = [];
            points.push(new THREE.Vector2(0, 0));
            points.push(new THREE.Vector2(0.4, 0.5));
            points.push(new THREE.Vector2(0.8, 1.5));
            points.push(new THREE.Vector2(0.6, 2.5));
            points.push(new THREE.Vector2(0.2, 4.0));
            const bodyGeom = new THREE.LatheGeometry(points, 20);
            bodyGeom.rotateX(-Math.PI / 2); 
            bodyGeom.translate(0, 0, 1.5);
            const bodyMesh = new THREE.Mesh(bodyGeom, shaderMat);
            bodyMesh.scale.set(0.4, 1.2, 1); 
            fishGroup.add(bodyMesh);

            // Tail
            const tailShape = new THREE.Shape();
            tailShape.moveTo(0, 0); tailShape.quadraticCurveTo(0, 0.5, 0.5, 1.0);
            tailShape.lineTo(1.2, 1.5); tailShape.lineTo(0.8, 0); tailShape.lineTo(1.2, -1.5);
            tailShape.quadraticCurveTo(0.5, -1.0, 0, 0);
            const tailGeom = new THREE.ExtrudeGeometry(tailShape, { depth: 0.1, bevelEnabled: false });
            tailGeom.rotateY(Math.PI / 2); tailGeom.translate(-0.05, 0, -4.0);
            fishGroup.add(new THREE.Mesh(tailGeom, shaderMat));

            fishGroup.scale.set(0.6, 0.6, 0.6);
            return fishGroup;
        }

        class Boid {
            constructor() {
                this.position = new THREE.Vector3((Math.random()-0.5)*80, (Math.random()-0.5)*60, (Math.random()-0.5)*40);
                this.velocity = new THREE.Vector3(Math.random()-0.5, Math.random()-0.5, Math.random()-0.5).normalize();
                this.acceleration = new THREE.Vector3();
                this.mesh = createOrganicFish();
                
                // Color Customization for Blue Sea Theme
                this.maxSpeed = 0.2 + Math.random() * 0.1;
                this.maxForce = 0.005;
                const scale = 0.5 + Math.random() * 0.4;
                this.mesh.scale.set(scale, scale, scale);
                
                // Blue/Teal/Purple Hues
                const hue = 0.5 + Math.random() * 0.2; // 0.5 is Cyan, 0.7 is Purple
                this.mesh.children.forEach(c => {
                    if(c.material && c.material.uniforms) {
                        c.material.uniforms.color.value.setHSL(hue, 0.8, 0.4);
                        c.material.uniforms.glowColor.value.setHSL(hue, 1.0, 0.6);
                    }
                });
                
                this.wiggleOffset = Math.random() * 100;
                this.wanderAngle = Math.random() * Math.PI * 2;
                scene.add(this.mesh);
            }

            flock(boids, target, isTouching) {
                let separation = new THREE.Vector3(), alignment = new THREE.Vector3(), cohesion = new THREE.Vector3();
                let count = 0;
                boids.forEach(other => {
                    if (other === this) return;
                    const dist = this.position.distanceTo(other.position);
                    if (dist < NEIGHBOR_DIST && dist > 0) {
                        cohesion.add(other.position);
                        alignment.add(other.velocity);
                        if (dist < SEPARATION_DIST) {
                            const diff = new THREE.Vector3().copy(this.position).sub(other.position);
                            diff.normalize().divideScalar(dist);
                            separation.add(diff);
                        }
                        count++;
                    }
                });

                if (count > 0) {
                    cohesion.divideScalar(count).sub(this.position).setLength(this.maxSpeed).sub(this.velocity).clampLength(0, this.maxForce);
                    alignment.divideScalar(count).setLength(this.maxSpeed).sub(this.velocity).clampLength(0, this.maxForce);
                    separation.divideScalar(count).setLength(this.maxSpeed).sub(this.velocity).clampLength(0, this.maxForce);
                }

                this.acceleration.add(separation.multiplyScalar(2.0));
                this.acceleration.add(alignment.multiplyScalar(0.3));
                this.acceleration.add(cohesion.multiplyScalar(0.1));

                if (isTouching && target.length() > 0) {
                    const seek = new THREE.Vector3().copy(target).sub(this.position).setLength(this.maxSpeed).sub(this.velocity).clampLength(0, this.maxForce * 1.5);
                    this.acceleration.add(seek.multiplyScalar(1.2));
                } else {
                    this.wanderAngle += (Math.random() - 0.5) * 0.3;
                    const wander = new THREE.Vector3(Math.cos(this.wanderAngle)*0.015, (Math.random()-0.5)*0.015, Math.sin(this.wanderAngle)*0.015);
                    this.acceleration.add(wander);
                }
            }

            update(time) {
                this.position.add(this.velocity);
                this.velocity.add(this.acceleration);
                this.velocity.clampLength(0, this.maxSpeed);
                this.acceleration.set(0, 0, 0);
                this.mesh.position.copy(this.position);
                if (this.velocity.length() > 0.01) this.mesh.lookAt(new THREE.Vector3().copy(this.position).add(this.velocity));
                this.mesh.children.forEach(c => { if(c.material) c.material.uniforms.time.value = time + this.wiggleOffset; });
            }
        }

        const boids = [];
        for(let i=0; i<FISH_COUNT; i++) boids.push(new Boid());

        // Particles
        const pGeom = new THREE.BufferGeometry();
        const pPos = new Float32Array(1000 * 3);
        for(let i=0; i<3000; i++) pPos[i] = (Math.random()-0.5) * 100;
        pGeom.setAttribute('position', new THREE.BufferAttribute(pPos, 3));
        const particles = new THREE.Points(pGeom, new THREE.PointsMaterial({color: 0x00c3ff, size: 0.1, transparent: true, opacity: 0.3}));
        scene.add(particles);

        // Interaction
        let mouse = new THREE.Vector2(), target = new THREE.Vector3(), isTouching = false;
        let scrollY = 0;
        const clock = new THREE.Clock();

        function updateMouse(x, y) {
            mouse.x = (x / window.innerWidth) * 2 - 1;
            mouse.y = -(y / window.innerHeight) * 2 + 1;
            target.set(mouse.x * 40, mouse.y * 25, 0);
        }

        document.addEventListener('mousemove', e => { if(!isTouching) updateMouse(e.clientX, e.clientY); });
        document.addEventListener('touchstart', e => { isTouching = true; updateMouse(e.touches[0].clientX, e.touches[0].clientY); });
        document.addEventListener('touchmove', e => { if(e.touches.length) updateMouse(e.touches[0].clientX, e.touches[0].clientY); });
        document.addEventListener('touchend', () => isTouching = false);
        window.addEventListener('scroll', () => scrollY = window.scrollY);

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();
            boids.forEach(b => { b.flock(boids, target, isTouching); b.update(time); });
            
            // Parallax effect for depth
            camera.position.y = THREE.MathUtils.lerp(camera.position.y, -scrollY * 0.02, 0.05);
            particles.position.y = -scrollY * 0.05;

            cursorLight.position.copy(target);
            cursorLight.position.z = 10;
            cursorLight.intensity = isTouching ? 2 : 0.8;
            composer.render();
        }

        setTimeout(() => {
            const l = document.getElementById('loader');
            l.style.opacity = '0';
            setTimeout(() => l.remove(), 1000);
        }, 1500);

        animate();
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- MOBILE MENU LOGIC: animated hamburger, slide-down, and body lock ---
        const menuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileLinks = document.querySelectorAll('.mobile-link');

        function setMenuOpen(open) {
            if (open) {
                menuBtn.classList.add('open');
                mobileMenu.classList.add('open');
                menuBtn.setAttribute('aria-expanded', 'true');
                menuBtn.setAttribute('aria-label', 'Close menu');
                document.body.classList.add('menu-open');

                // stagger link reveals
                mobileLinks.forEach((lnk, i) => {
                    lnk.style.transitionDelay = `${i * 0.06}s`;
                });
            } else {
                menuBtn.classList.remove('open');
                mobileMenu.classList.remove('open');
                menuBtn.setAttribute('aria-expanded', 'false');
                menuBtn.setAttribute('aria-label', 'Toggle menu');
                document.body.classList.remove('menu-open');

                // reset delays
                mobileLinks.forEach(lnk => {
                    lnk.style.transitionDelay = '';
                });
            }
        }

        menuBtn.addEventListener('click', () => {
            const isOpen = menuBtn.classList.contains('open');
            setMenuOpen(!isOpen);
        });

        // Close menu when a link is clicked
        mobileLinks.forEach(link => {
            link.addEventListener('click', () => {
                setMenuOpen(false);
            });
        });

        // Close with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') setMenuOpen(false);
        });

        // Close when clicking outside the menu (on the overlay area)
        mobileMenu.addEventListener('click', (e) => {
            if (e.target === mobileMenu) setMenuOpen(false);
        });
    </script>
</body>
</html>